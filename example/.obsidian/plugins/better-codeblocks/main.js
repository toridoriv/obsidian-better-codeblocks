//@ts-nocheck
var c=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var i=(r,e)=>c(r,"name",{value:e,configurable:!0});var E=(r,e)=>{for(var t in e)c(r,t,{get:e[t],enumerable:!0})},B=(r,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of T(e))!_.call(r,n)&&n!==t&&c(r,n,{get:()=>e[n],enumerable:!(o=M(e,n))||o.enumerable});return r};var F=r=>B(c({},"__esModule",{value:!0}),r);var G={};E(G,{default:()=>j});module.exports=F(G);var P=require("obsidian");var x=require("obsidian");function f(r){return r[0]}i(f,"first");function h(r,e){let t=typeof r=="string"?new RegExp(r,"g"):new RegExp(r.source,r.flags||"g");return[...e.matchAll(t)].map(f)}i(h,"matchAll");function g(r){let e=r.split(/<\S*>/),t=h(/<\S*>.*<\/\S*>/,r),o=document.createDocumentFragment();for(let n of e){let a=t.find(p=>p.includes(n)),l=y(a||`<span>${n}</span>`);o.appendChild(l)}return o}i(g,"getMessageFragment");function y(r){return new DOMParser().parseFromString(r.trim(),"text/html").getElementsByTagName("body")[0].firstChild||document.createElement("span")}i(y,"stringToHtml");var s=class r{constructor(e){this.plugin=e}static{i(this,"Announcer")}static#e=null;static plugin;static initialize(e){this.#e||(this.plugin=e,this.#e=new r(this.plugin))}static get instance(){if(!this.#e)throw new Error("Announcer not initialized");return this.#e}createNotice(e,t=1e4){let o=typeof e=="string"?g(e):e,n=document.createElement("footer");return n.textContent=this.plugin.manifest.name+" Plugin",n.style.fontSize="xx-small",n.style.opacity="0.5",n.style.borderTop="1px solid var(--text-muted)",n.style.marginTop="1em",n.style.paddingTop="0.5em",n.style.textAlign="right",o.appendChild(n),new x.Notice(o,t)}success(e,t=15e3){return this.createNotice(`‚ú® ${e}`,t)}info(e,t=15e3){return this.createNotice(`üí¨ ${e}`,t)}failure(e,t=15e3){return this.createNotice(`‚ùå ${e}`,t)}warn(e,t=1e4){let o=document.createDocumentFragment(),n=document.createElement("span");return n.innerHTML="‚ö†Ô∏è",n.classList.add("emoji"),o.append(n," ",g(e)),this.createNotice(o,t)}cannotRun(e,t){return this.warn(`The task <strong><u>${e}</u></strong> cannot be run ${t}.`)}error(e,t,o=2e4){return this.failure(`<p>${e}</p><code>${JSON.stringify({name:t.name,message:t.message,cause:t.cause},null,2)}</code>`,o)}};var k=require("obsidian");function u(r,e){let t=r[e],o={pattern:/^\b$/};return t?t instanceof RegExp?{pattern:t}:Array.isArray(t)?o:t:o}i(u,"getGrammarToken");function b(){let r="if (stream != state.thisLine.stream)",{CodeMirror:e}=window,t=e.modes.markdown;if(t.isPatch)return;let o=t.toString(),n=o.indexOf(r),a=o.substring(0,n).replace("function(cmCfg, modeCfg)",""),l=o.substring(n),C=[a,"state.quote = 0;",l].join("").replace("modeCfg.strikethrough = false;","modeCfg.strikethrough = true;"),d=new Function("cmCfg","modeCfg",`"use strict"; return function markdown(cmCfg, modeCfg) ${C};`)();Object.defineProperty(d,"dependencies",{enumerable:!0,configurable:!0,value:["xml"]}),Object.defineProperty(d,"isPatch",{enumerable:!1,configurable:!1,value:!0}),e.defineMode("markdown",d)}i(b,"patchCodeMirror");async function w(){let r=await(0,k.loadPrism)(),e=r.languages.markdown,t={...u(e,"bold"),pattern:/\*{2}[^\n\r]+\*{2}|_{2}[^\n\r]+_{2}/gm,alias:["inline"]},o={...u(e,"italic"),pattern:/\*{1}[^\n\r *]{1,}[^\n\r*]+[^\n\r *]{1,}\*{1}(?!.*\*)|_{1}[^\n\r _]{1,}[^\n\r_]+[^\n\r _]{1,}_{1}(?!.*_)/gm,alias:["inline"]},n={blockquote:{alias:["block","thematic-break"],pattern:/^>{1,} ?[^\n\r]*[\n|\r]{0,}/gm,inside:{bold:t,italic:o}},bold:t,italic:o,list:{...u(e,"list"),alias:["block","thematic-break"],pattern:/^[ \t]{0,}(\d{1,}\. [^\n\r]*[\n|\r]{0,1}|[-*+] [^\n\r]*[\n|\r]{0,1})/gm,greedy:!1,lookbehind:!1,inside:{bold:t,italic:o}}};r.languages.markdown=r.languages.extend("markdown",n),r.languages.md=r.languages.extend("md",n)}i(w,"patchPrism");var m=class extends P.Plugin{static{i(this,"BetterCodeBlocksPlugin")}onload(){s.initialize(this),b(),w().then(()=>{s.instance.info("Prism.js loaded!",3e3)}).catch(e=>{s.instance.error(e.message,e,3e3)}),s.instance.info("Better Code Blocks plugin loaded!",3e3)}};var j=m;
